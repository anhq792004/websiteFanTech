<!DOCTYPE html>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:insert="~{/admin/fragments/head :: head}"></head>
<body>
<!-- Site wrapper -->
<div class="wrapper">
    <!-- Sidebar -->
    <div>
        <aside th:replace="/admin/fragments/sidebar :: sidebar"></aside>
    </div>

    <!-- Main-->
    <div id="main">
        <header th:replace="/admin/fragments/header :: header"></header>
        <div class="page-content">
            <!--        dữ liệu thực hiện trong secsion-->
            <section class="row">
                <div class="card">
                    <div class="card-header">
                        <div class="row">
                            <div class="bg-white shadow-sm rounded p-3 d-flex justify-content-between align-items-center">
                                <!-- Tabs Danh sách hóa đơn -->
                                <div class="overflow-auto flex-grow-1 me-3" style="max-width: 100%; overflow-x: auto;">
                                    <ul class="nav nav-pills d-flex flex-nowrap align-items-center gap-3 mb-0">
                                        <!-- Lặp qua danh sách hóa đơn với chỉ số -->
                                        <li class="nav-item" th:each="hd : ${listHoaDon}">
                                            <a class="nav-link"
                                               th:classappend="${hd.id == idHD} ? 'active bg-success text-white' : 'text-dark border border-light'"
                                               th:text="${hd.ma}"
                                               th:href="@{/sale/hdct(idHD=${hd.id})}">
                                            </a>
<!--                                            <a class="text-danger"-->
<!--                                               href="javascript:void(0);"-->
<!--                                               th:onclick="'xoaHoaDon(' + ${hd.id} + ', ' + (${#lists.isEmpty(hd.hoaDonChiTietList) ? false : true}) + ');'">-->
<!--                                                <i class="bi bi-x"></i>-->
<!--                                            </a>-->
                                        </li>
                                    </ul>
                                </div>
                                <!-- Nút Thêm Hóa Đơn -->
                                <form id="taoHoaDon" method="post" action="/sale/tao-tao-don">
                                    <button type="submit" class="btn btn-outline-success"
                                            style="width: 60px; text-align: center" >
                                        <i class="bi bi-patch-plus-fill"></i>
                                    </button>
                                </form>
                                <div id="message" class="mt-3"></div>

                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                    </div>

                </div>
            </section>
        </div>
    </div>
    <!-- Footer-->
    <div>
        <footer th:replace="/admin/fragments/footer :: footer"></footer>
    </div>
</div>
<script th:replace="/admin/fragments/script :: script"></script>

<script>
    $('#taoHoaDon').on('submit', function (e) {
        e.preventDefault(); // Ngăn form thực hiện submit mặc định

        $.ajax({
            url: '/sale/tao-hoa-don',
            type: 'POST',
            success: function (response) {
                Swal.fire({
                    toast: true,
                    icon: 'success',
                    title: response, // Thông báo thành công từ server
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 1000,
                    timerProgressBar: true
                }).then(() => {
                    location.reload();
                });
            },
            error: function (xhr) {
                Swal.fire({
                    toast: true,
                    icon: 'error',
                    title: xhr.responseText, // Thông báo lỗi trả về từ controller
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 2000,
                    timerProgressBar: true
                }).then(() => {
                    location.reload();
                });
            }
        });
    });
</script>
</body>
</html>
